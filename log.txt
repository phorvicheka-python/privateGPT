(privategpt-py3.11) (base) sonic@sonic-SYS-740P-TR:~/Desktop/projects/privateGPT$ python privateGPT.py
ggml_init_cublas: found 2 CUDA devices:
  Device 0: NVIDIA GeForce RTX 3090, compute capability 8.6
  Device 1: NVIDIA GeForce RTX 3090, compute capability 8.6
llama.cpp: loading model from /DATA2/projects/llm_models/llama-2-13b-chat.ggmlv3.q4_0.bin
llama_model_load_internal: format     = ggjt v3 (latest)
llama_model_load_internal: n_vocab    = 32000
llama_model_load_internal: n_ctx      = 2048
llama_model_load_internal: n_embd     = 5120
llama_model_load_internal: n_mult     = 256
llama_model_load_internal: n_head     = 40
llama_model_load_internal: n_head_kv  = 40
llama_model_load_internal: n_layer    = 40
llama_model_load_internal: n_rot      = 128
llama_model_load_internal: n_gqa      = 1
llama_model_load_internal: rnorm_eps  = 5.0e-06
llama_model_load_internal: n_ff       = 13824
llama_model_load_internal: freq_base  = 10000.0
llama_model_load_internal: freq_scale = 1
llama_model_load_internal: ftype      = 2 (mostly Q4_0)
llama_model_load_internal: model size = 13B
llama_model_load_internal: ggml ctx size =    0.11 MB
llama_model_load_internal: using CUDA for GPU acceleration
ggml_cuda_set_main_device: using device 0 (NVIDIA GeForce RTX 3090) as main device
llama_model_load_internal: mem required  =  582.00 MB (+ 1600.00 MB per state)
llama_model_load_internal: allocating batch_size x (640 kB + n_ctx x 160 B) = 480 MB VRAM for the scratch buffer
llama_model_load_internal: offloading 40 repeating layers to GPU
llama_model_load_internal: offloading non-repeating layers to GPU
llama_model_load_internal: offloading v cache to GPU
llama_model_load_internal: offloading k cache to GPU
llama_model_load_internal: offloaded 43/43 layers to GPU
llama_model_load_internal: total VRAM used: 8976 MB
llama_new_context_with_model: kv self size  = 1600.00 MB
AVX = 1 | AVX2 = 1 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | FMA = 1 | NEON = 0 | ARM_FMA = 0 | F16C = 1 | FP16_VA = 0 | WASM_SIMD = 0 | BLAS = 1 | SSE3 = 1 | VSX = 0 |

Enter a query: 고압산소치료는 무엇입니까?
Traceback (most recent call last):
  File "/home/sonic/Desktop/projects/privateGPT/privateGPT.py", line 128, in <module>
    main()
  File "/home/sonic/Desktop/projects/privateGPT/privateGPT.py", line 86, in main
    res = qa(query)
          ^^^^^^^^^
  File "/home/sonic/.cache/pypoetry/virtualenvs/privategpt-3t3Im28o-py3.11/lib/python3.11/site-packages/langchain/chains/base.py", line 282, in __call__
    raise e
  File "/home/sonic/.cache/pypoetry/virtualenvs/privategpt-3t3Im28o-py3.11/lib/python3.11/site-packages/langchain/chains/base.py", line 276, in __call__
    self._call(inputs, run_manager=run_manager)
  File "/home/sonic/.cache/pypoetry/virtualenvs/privategpt-3t3Im28o-py3.11/lib/python3.11/site-packages/langchain/chains/retrieval_qa/base.py", line 136, in _call
    docs = self._get_docs(question, run_manager=_run_manager)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sonic/.cache/pypoetry/virtualenvs/privategpt-3t3Im28o-py3.11/lib/python3.11/site-packages/langchain/chains/retrieval_qa/base.py", line 216, in _get_docs
    return self.retriever.get_relevant_documents(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sonic/.cache/pypoetry/virtualenvs/privategpt-3t3Im28o-py3.11/lib/python3.11/site-packages/langchain/schema/retriever.py", line 208, in get_relevant_documents
    raise e
  File "/home/sonic/.cache/pypoetry/virtualenvs/privategpt-3t3Im28o-py3.11/lib/python3.11/site-packages/langchain/schema/retriever.py", line 201, in get_relevant_documents
    result = self._get_relevant_documents(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sonic/.cache/pypoetry/virtualenvs/privategpt-3t3Im28o-py3.11/lib/python3.11/site-packages/langchain/vectorstores/base.py", line 564, in _get_relevant_documents
    docs = self.vectorstore.similarity_search(query, **self.search_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sonic/.cache/pypoetry/virtualenvs/privategpt-3t3Im28o-py3.11/lib/python3.11/site-packages/langchain/vectorstores/chroma.py", line 260, in similarity_search
    docs_and_scores = self.similarity_search_with_score(query, k, filter=filter)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sonic/.cache/pypoetry/virtualenvs/privategpt-3t3Im28o-py3.11/lib/python3.11/site-packages/langchain/vectorstores/chroma.py", line 333, in similarity_search_with_score
    results = self.__query_collection(
              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sonic/.cache/pypoetry/virtualenvs/privategpt-3t3Im28o-py3.11/lib/python3.11/site-packages/langchain/utils/utils.py", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/sonic/.cache/pypoetry/virtualenvs/privategpt-3t3Im28o-py3.11/lib/python3.11/site-packages/langchain/vectorstores/chroma.py", line 156, in __query_collection
    return self._collection.query(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sonic/.cache/pypoetry/virtualenvs/privategpt-3t3Im28o-py3.11/lib/python3.11/site-packages/chromadb/api/models/Collection.py", line 223, in query
    return self._client._query(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/sonic/.cache/pypoetry/virtualenvs/privategpt-3t3Im28o-py3.11/lib/python3.11/site-packages/chromadb/api/local.py", line 457, in _query
    uuids, distances = self._db.get_nearest_neighbors(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sonic/.cache/pypoetry/virtualenvs/privategpt-3t3Im28o-py3.11/lib/python3.11/site-packages/chromadb/db/clickhouse.py", line 613, in get_nearest_neighbors
    uuids, distances = index.get_nearest_neighbors(embeddings, n_results, ids)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sonic/.cache/pypoetry/virtualenvs/privategpt-3t3Im28o-py3.11/lib/python3.11/site-packages/chromadb/db/index/hnswlib.py", line 296, in get_nearest_neighbors
    database_labels, distances = self._index.knn_query(
                                 ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Cannot return the results in a contigious 2D array. Probably ef or M is too small